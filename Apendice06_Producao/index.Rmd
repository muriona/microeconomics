---
title: "Teoria da Produção"
subtitle: "Apêndice - Aula 06 - Curto Prazo"
author: "Prof. Mauricio Uriona Maldonado"
institute: "EPS 5222"
date: "`r format(Sys.Date(), '%d/%m/%Y')`"
output:
  xaringan::moon_reader:
    self_contained: false
    lib_dir: libs
    css: ["default", "rladies", "rladies-fonts"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE,
        echo = FALSE)
```

```{r share-again, echo=FALSE}
xaringanExtra::use_share_again()
```

# Função de Produção

- Vamos começar entendendo a forma de uma função de produção quando apenas um insumo é variável.


```{r echo = FALSE, message=FALSE, warning=FALSE}
library(Deriv)
library(tidyverse)
library(DT)
library(glue)
library(knitr)

#funcao_prod <- function(h){
  
#  (154/(1+exp(-0.8*(h-5))))+1
#}

funcao_prod <- function(x){
  -0.5*x^3+6*x^2-x
  }


L <- seq(from= 0.1, to=10, by=0.1)
Q <- funcao_prod(L)
producao <- data.frame(L,Q=round(Q,2))

#datatable(producao, options = list(
#  initComplete = JS(
#    "function(settings, json) {",
#    "$(this.api().table().header()).css({'font-size': '15px', 'background-color': '#c2d1f0', 'color': '#fff'});",
#    "}"))) %>%  formatStyle(columns = colnames(.$x$data), `font-size` = '12px')

producao %>% 
  filter(L %in% c(1:10)) %>% 
  knitr::kable()
```



---
# Graficar

- Os dados da tabela podem ser representados como uma função de produção: $$F_{(L)}=-0.5L^3+6L^2-L$$

--


```{r, echo =FALSE, fig.height=5, fig.width=8, fig.retina=2}


funcao_prod2 <- function(K,L){
  (K^0.5)*(L^0.5)
}

PMg <- Deriv(funcao_prod, "x")


producao <- producao %>% 
  mutate(
         PMg = PMg(L),
         PMe = (Q/L))

PMe_empirical <- splinefun(x=producao$L,
                             y=producao$PMe)

producao %>% 
  ggplot(aes(L,Q))+
  geom_line(color="#e32d91", size=2)+
  geom_label(aes(x=9.5,y=funcao_prod(9.5)), color = "#e32d91", label="Produto Total", size = 5)+
  labs(x = "Horas Trabalhadas x1000 (L)", 
       y = "Unidades Produzidas x1000 (Q)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 10, 1)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 130, 20)) +
  coord_cartesian(xlim = c(0, 11), ylim = c(0, 135)) +
  theme_classic()+
  theme(axis.text=element_text(size=14),
        axis.title=element_text(size=16, face="bold"))
```


---
# Calculando PMg e PMe

- O PMg pode ser entendido como a derivada $$\frac{\partial F_{L}}{\partial L}$$
--

- No nosso caso: $$\frac{\partial F_{(L)}}{\partial L}=-1.5L^2+12L-1$$

--

- Já, o PMe pode ser entendido como o produto médio por unidade de trabalho: $$\frac{F_{(L)}}{L}$$

--

- No nosso caso: $$\frac{F_{(L)}}{L}=-0.5L^2+6L-1$$

---

# Tabela com Q, L, PMg e PMe

```{r echo = FALSE}
library(DT)

producao <- producao %>% 
  mutate(PMe = round(PMe, 2),
         PMg = round(PMg, 2))

#datatable(producao,
#          extensions = 'Buttons', options = list(
##     dom = 'Bfrtip',
#     buttons = c('copy', 'csv', 'excel', 'pdf', 'print')),
#     width = "200px", height = "200px") %>% 
#  formatStyle(columns = colnames(c(1,2,3,4)), fontSize = '20%')

datatable(producao)
```

---

# Graficando o PMg e o PMe (1 de 2)

--

- Vamos graficar o PMg e o PMe para entender suas trajetórias
--
```{r echo = FALSE, fig.height=5, fig.width=8, fig.retina=2, fig.align='center'}

colors <- c("PMg" = "#e32d91", "PMe"="blue")

outputperunit <- producao %>% 
 # filter(L>1) %>% 
  ggplot(aes(x=L))+
  geom_line(aes(y= PMg, color="PMg"), size=2)+
  geom_line(aes(y=PMe, color="PMe"), size=2)+
  geom_hline(yintercept = 0, size = 1.2, linetype = 2)+
  geom_label(aes(x=7.5,y=PMg(7.5)), color = "#e32d91", label="PMg", size = 5)+
  geom_label(aes(x=9.5,y=PMe_empirical(9.5)), color = "blue", label="PMe", size = 5)+
  scale_color_manual(values=colors)+
  labs(x = "Horas Trabalhadas x1000 (L)", 
       y = "Unidades x1000 por horas x1000 (Q/L)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 10, 1)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(-10, 30, 5)) +
  coord_cartesian(xlim = c(0, 11), ylim = c(-10, 35)) +
  theme_classic()+
  theme(axis.text=element_text(size=14),
        axis.title=element_text(size=16, face="bold"),
        legend.position = "none")

outputperunit
```

--
- Conforme a figura, o PMg cresce até atingir um máximo e logo cair rapidamente, já o PMe apresenta um comportamento mais estável.

---
# Graficando o PMg e o PMe (2 de 2)

- Uma propriedade interessante é que o máximo do PMe é exatamente o ponto onde cruza com o PMg.

--
--
```{r echo = FALSE, fig.height=5, fig.width=8, fig.retina=2, fig.align='center'}


optimal <- uniroot(function(x) PMg(x) - PMe_empirical(x), c(4,10))

L_otimo <- round(optimal$root)


outputperunit+
  annotate("point", x=6, y=PMe_empirical(6), size=5, color="orange")+
  annotate("text", x=L_otimo, y=PMe_empirical(6)+3, label = glue("({L_otimo}, {PMe_empirical(L_otimo)})"))+
  geom_vline(xintercept = 6, linetype = 3)+
  geom_hline(yintercept = PMe_empirical(6), linetype = 3)
  

```

---

class: center, middle

# Fim do Apêndice

Prof. Mauricio Uriona Maldonado
